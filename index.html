<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
Jogo da Nova</title>
    <style>
        :root {
            --board-bg: #2c3e50;
            --cell-bg: #34495e;
            --cell-hover-bg: #4a6572;
            --text-color: #ecf0f1;
            --heart-color: #e74c3c;
            --star-color: #f1c40f;
            --pyramid-color: #3498db;
            --win-bg: rgba(46, 204, 113, 0.7);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--board-bg);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            text-align: center;
        }

        #game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        h1 {
            font-size: clamp(2rem, 6vw, 3rem);
            margin-bottom: 10px;
        }

        #status {
            font-size: clamp(1.2rem, 4vw, 1.5rem);
            min-height: 50px;
            margin-bottom: 20px;
        }

        #game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 10px;
            width: clamp(300px, 90vw, 500px);
            height: clamp(300px, 90vw, 500px);
            background-color: #233140;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .cell {
            background-color: var(--cell-bg);
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: clamp(2rem, 10vw, 3.5rem);
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
            user-select: none;
        }

        .cell:not(.placed):hover {
            background-color: var(--cell-hover-bg);
        }

        .cell.provisional {
            opacity: 0.6;
            transform: scale(0.95);
            border: 2px dashed var(--text-color);
        }

        .cell .symbol-‚ù§Ô∏è { color: var(--heart-color); }
        .cell .symbol-‚≠ê { color: var(--star-color); }
        .cell .symbol-üî∫ { color: var(--pyramid-color); }

        .cell.winner {
            background-color: var(--win-bg);
            animation: pulse 0.8s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        #controls {
            margin-top: 20px;
        }

        #confirm-btn {
            font-size: 1.2rem;
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            background-color: #27ae60;
            color: white;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
        }

        #confirm-btn:disabled {
            background-color: #7f8c8d;
            cursor: not-allowed;
        }

        #confirm-btn:not(:disabled):hover {
            background-color: #2ecc71;
            transform: translateY(-2px);
        }

        #game-over-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 1000;
            transition: opacity 0.3s;
        }

        #game-over-modal.hidden {
            display: none;
            opacity: 0;
        }

        .modal-content {
            background-color: var(--cell-bg);
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
        }

        #game-over-message {
            font-size: 1.8rem;
            margin-bottom: 25px;
        }

        #restart-btn {
            font-size: 1.2rem;
            padding: 12px 25px;
            border-radius: 8px;
            border: none;
            background-color: #3498db;
            color: white;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        #restart-btn:hover {
            background-color: #5dade2;
        }
    </style>
</head>
<body>

    <div id="game-container">
        <h1>Tr√≠ade T√°tica 4x4</h1>
        <h2 id="status">Sorteando o primeiro jogador...</h2>
        <div id="game-board"></div>
        <div id="controls">
            <button id="confirm-btn" disabled>Confirmar Jogada</button>
        </div>
    </div>

    <div id="game-over-modal" class="hidden">
        <div class="modal-content">
            <p id="game-over-message"></p>
            <button id="restart-btn">Jogar Novamente</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const boardElement = document.getElementById('game-board');
            const statusElement = document.getElementById('status');
            const confirmBtn = document.getElementById('confirm-btn');
            const gameOverModal = document.getElementById('game-over-modal');
            const gameOverMessage = document.getElementById('game-over-message');
            const restartBtn = document.getElementById('restart-btn');

            const players = [
                { symbol: '‚ù§Ô∏è', name: 'Cora√ß√£o' },
                { symbol: '‚≠ê', name: 'Estrela' },
                { symbol: 'üî∫', name: 'Pir√¢mide' }
            ];
            const BOARD_SIZE = 16;
            
            let boardState;
            let currentPlayerIndex;
            let gameActive;
            let provisionalMove = null;
            let movesMade;

            const winningCombinations = [
                // Horizontais (3 em linha)
                [0, 1, 2], [1, 2, 3], [4, 5, 6], [5, 6, 7],
                [8, 9, 10], [9, 10, 11], [12, 13, 14], [13, 14, 15],
                // Verticais (3 em linha)
                [0, 4, 8], [4, 8, 12], [1, 5, 9], [5, 9, 13],
                [2, 6, 10], [6, 10, 14], [3, 7, 11], [7, 11, 15],
                // Diagonais (de cima para baixo, esquerda para direita)
                [0, 5, 10], [1, 6, 11], [2, 7, 12], [4, 9, 14], [5, 10, 15], [3, 6, 9],
                // Diagonais (de cima para baixo, direita para esquerda)
                [2, 5, 8], [1, 5, 9], [0, 5, 10], [3, 6, 9], [4, 9, 14],
                [3, 7, 11], [2, 6, 10], [1, 5, 9], [7, 10, 13], [6, 9, 12],
                [3, 6, 9], [2, 5, 8], [7, 11, 15], [6, 10, 14], [5, 9, 13],
                // Ajuste para garantir combina√ß√µes √∫nicas e corretas de 3 em linha no 4x4
                 // Horizontals
                [0, 1, 2], [1, 2, 3], [4, 5, 6], [5, 6, 7], [8, 9, 10], [9, 10, 11], [12, 13, 14], [13, 14, 15],
                // Verticals
                [0, 4, 8], [4, 8, 12], [1, 5, 9], [5, 9, 13], [2, 6, 10], [6, 10, 14], [3, 7, 11], [7, 11, 15],
                // Diagonals (top-left to bottom-right)
                [0, 5, 10], [5, 10, 15], [1, 6, 11], [4, 9, 14], [2, 7, 12], [3, 6, 9],
                // Diagonals (top-right to bottom-left)
                [3, 6, 9], [2, 5, 8], [7, 10, 13], [1, 5, 9], [6, 9, 12]
            ];
            // Para remover duplicatas
            const uniqueWinningCombinations = [...new Set(winningCombinations.map(JSON.stringify))].map(JSON.parse);


            function startGame() {
                boardState = Array(BOARD_SIZE).fill(null);
                gameActive = true;
                provisionalMove = null;
                movesMade = 0;
                
                boardElement.innerHTML = '';
                for (let i = 0; i < BOARD_SIZE; i++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.dataset.index = i;
                    boardElement.appendChild(cell);
                }
                
                document.querySelectorAll('.cell').forEach(cell => cell.addEventListener('click', handleCellClick));

                confirmBtn.disabled = true;
                gameOverModal.classList.add('hidden');

                // Sorteio inicial
                currentPlayerIndex = Math.floor(Math.random() * players.length);
                const startingPlayer = players[currentPlayerIndex];
                statusElement.innerHTML = `O sorteio decidiu: <span class="symbol-${startingPlayer.symbol}">${startingPlayer.symbol}</span> come√ßa a partida!`;
                
                setTimeout(() => updateTurnStatus(), 2000);
            }
            
            function updateTurnStatus() {
                if (!gameActive) return;
                const currentPlayer = players[currentPlayerIndex];
                statusElement.innerHTML = `Vez de: <span class="symbol-${currentPlayer.symbol}">${currentPlayer.symbol}</span>`;
            }

            function handleCellClick(event) {
                if (!gameActive) return;

                const clickedCell = event.target;
                const clickedIndex = parseInt(clickedCell.dataset.index);

                if (boardState[clickedIndex] !== null) {
                    return; // C√©lula j√° ocupada
                }

                // Limpa a marca√ß√£o provis√≥ria anterior
                if (provisionalMove !== null) {
                    const prevCell = boardElement.children[provisionalMove.index];
                    prevCell.innerHTML = '';
                    prevCell.classList.remove('provisional');
                }
                
                // Define a nova marca√ß√£o provis√≥ria
                const currentPlayer = players[currentPlayerIndex];
                clickedCell.innerHTML = `<span class="symbol-${currentPlayer.symbol}">${currentPlayer.symbol}</span>`;
                clickedCell.classList.add('provisional');
                provisionalMove = { index: clickedIndex, symbol: currentPlayer.symbol };
                
                confirmBtn.disabled = false;
            }

            function handleConfirmClick() {
                if (provisionalMove === null || !gameActive) return;

                const { index, symbol } = provisionalMove;
                
                boardState[index] = symbol;
                const cellToUpdate = boardElement.children[index];
                cellToUpdate.classList.remove('provisional');
                cellToUpdate.classList.add('placed');
                movesMade++;

                if (checkWin()) {
                    endGame(false, getWinningCombination());
                } else if (movesMade === BOARD_SIZE) {
                    endGame(true, null);
                } else {
                    currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
                    updateTurnStatus();
                    provisionalMove = null;
                    confirmBtn.disabled = true;
                }
            }

            function checkWin() {
                const currentPlayerSymbol = players[currentPlayerIndex].symbol;
                return uniqueWinningCombinations.some(combination => {
                    return combination.every(index => boardState[index] === currentPlayerSymbol);
                });
            }

            function getWinningCombination() {
                 const currentPlayerSymbol = players[currentPlayerIndex].symbol;
                 return uniqueWinningCombinations.find(combination => {
                    return combination.every(index => boardState[index] === currentPlayerSymbol);
                });
            }

            function endGame(isDraw, winningCombination) {
                gameActive = false;
                confirmBtn.disabled = true;

                if (isDraw) {
                    gameOverMessage.innerHTML = "Empate! Ningu√©m venceu.";
                } else {
                    const winner = players[currentPlayerIndex];
                    gameOverMessage.innerHTML = `Parab√©ns, Jogador ${winner.name} (<span class="symbol-${winner.symbol}">${winner.symbol}</span>)! Voc√™ venceu!`;
                    winningCombination.forEach(index => {
                        boardElement.children[index].classList.add('winner');
                    });
                }
                gameOverModal.classList.remove('hidden');
                gameOverModal.style.opacity = 1;
            }

            confirmBtn.addEventListener('click', handleConfirmClick);
            restartBtn.addEventListener('click', startGame);

            startGame();
        });
    </script>

</body>
</html>
